{% extends "base.html" %}
{% block title %}My Leads{% endblock %}
{% block content %}
<div class="container-fluid py-4">
    <h2 class="mb-4">My Leads</h2>
    <div class="card mb-4">
        <div class="card-body">
            <form method="get" class="row g-3">
                <div class="col-md-4">
                    <select name="status" class="form-select">
                        <option value="">All Statuses</option>
                        <option value="new" {{ 'selected' if selected_status == 'new' else '' }}>New</option>
                        <option value="contacted" {{ 'selected' if selected_status == 'contacted' else '' }}>Contacted</option>
                        <option value="interested" {{ 'selected' if selected_status == 'interested' else '' }}>Interested</option>
                        <option value="converted" {{ 'selected' if selected_status == 'converted' else '' }}>Converted</option>
                        <option value="closed" {{ 'selected' if selected_status == 'closed' else '' }}>Closed</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <select name="source" class="form-select">
                        <option value="">All Sources</option>
                        <option value="website" {{ 'selected' if selected_source == 'website' else '' }}>Website</option>
                        <option value="card" {{ 'selected' if selected_source == 'card' else '' }}>Card</option>
                        <option value="api" {{ 'selected' if selected_source == 'api' else '' }}>API</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <button type="submit" class="btn btn-primary w-100">Filter</button>
                </div>
            </form>
        </div>
    </div>
    <div class="card">
        <div class="card-body p-0">
            <table class="table table-hover mb-0">
                <thead><tr><th>Name</th><th>Phone</th><th>Status</th><th>Follow-up</th><th>Created</th><th>Actions</th></tr></thead>
                <tbody>
                {% for lead in leads %}
                <tr>
                    <td>{{ lead.name or '-' }}</td>
                    <td><a href="tel:{{ lead.phone }}">{{ lead.phone }}</a></td>
                    <td><span class="badge bg-{{ 'success' if lead.status == 'converted' else 'danger' if lead.status == 'closed' else 'primary' }}">{{ lead.status }}</span></td>
                    <td>{{ lead.follow_up_date[:10] if lead.follow_up_date else '-' }}</td>
                    <td>{{ lead.created_at[:10] }}</td>
                    <td><a href="{{ url_for('sales.view_lead', id=lead.id) }}" class="btn btn-sm btn-outline-primary">View</a></td>
                </tr>
                {% else %}
                <tr><td colspan="6" class="text-center text-muted py-4">No leads found</td></tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
